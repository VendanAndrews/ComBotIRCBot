{"ts":1342136257732,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var irc = require('irc');\r\nvar express = require('express');\r\n\r\nvar client = new irc.Client('irc.lavishsoft.com', 'ComBot', {\r\n    channels: ['#combot'],\r\n    password: process.env.IRCPASSWORD,\r\n    autoConnect: false\r\n    });\r\n    \r\nsetTimeout(function(){\r\n    client.connect();\r\n}, 15000);\r\n\r\nclient.addListener('+mode', function (channel, by, mode, argument, message) {\r\n    client.raw\r\n});\r\n\r\nvar app = express.createServer();\r\napp.use(express.bodyParser());\r\n\r\napp.post('/', function(req, res){\r\n    var push = JSON.parse(req.body.payload);\r\n    console.log(push);\r\n    var reponame = irc.colors.wrap('dark_red', '[' + push.repository.name +']');\r\n    //client.say('#combot', push.pusher.name + \" pushed commits\");\r\n    var plural = '';\r\n    if(push.commits.length>1)\r\n    {\r\n        plural = 's';\r\n    }\r\n    var branch = push.ref.replace(/^refs\\/heads\\//,'');\r\n    if(branch=='')\r\n    {\r\n        client.say('#combot', reponame + ' ' + push.pusher.name + ' pushed ' + push.commits.length + ' new commit' + plural);\r\n    }\r\n    else\r\n    {\r\n        client.say('#combot', reponame + ' ' + push.pusher.name + ' pushed ' + push.commits.length + ' new commit' + plural + ' to ' + branch);\r\n        reponame = irc.colors.wrap('dark_red', '[' + push.repository.name + '\\\\' + branch + ']');\r\n    }\r\n    for(var i in push.commits)\r\n    {\r\n        //console.log(push.commits[i]);\r\n        var lines = push.commits[i].message.split('\\n');\r\n        if(lines.length > 1)\r\n        {\r\n            for(var line in lines)\r\n            {\r\n                if(line==lines.length-1)\r\n                {\r\n                    client.say('#combot', reponame + '     ' + lines[line] + ' - ' + push.commits[i].committer.name);\r\n                }\r\n                else if(line==0)\r\n                {\r\n                    client.say('#combot', reponame + ' ' + lines[line]);\r\n                }\r\n                else\r\n                {\r\n                    client.say('#combot', reponame + '     ' + lines[line]);\r\n                }\r\n            }\r\n        }\r\n        else\r\n        {\r\n            client.say('#combot', reponame + ' ' + lines[0] + ' - ' + push.commits[i].committer.name);\r\n        }\r\n        \r\n    }\r\n    res.send();\r\n});\r\n\r\napp.get('/', function(req, res){\r\n    \r\n   res.send('Bot Working'); \r\n    \r\n});\r\n\r\napp.listen(process.env.PORT, '0.0.0.0');"]],"start1":0,"start2":0,"length1":0,"length2":2340}]],"length":2340}
{"contributors":[],"silentsave":false,"ts":1342136299959,"patch":[[{"diffs":[[0,"'')\r\n    {\r\n    "],[-1,"    "],[1,"\t"],[0,"client.say('#com"]],"start1":883,"start2":883,"length1":36,"length2":33}]],"length":2337,"saved":false}
{"ts":1342136306718,"patch":[[{"diffs":[[0,"branch=="],[1,"="],[0,"'')\r\n   "]],"start1":875,"start2":875,"length1":16,"length2":17}]],"length":2338,"saved":false}
{"ts":1342136312301,"patch":[[{"diffs":[[0,"f(line=="],[1,"="],[0,"0)\r\n    "]],"start1":1746,"start2":1746,"length1":16,"length2":17}]],"length":2339,"saved":false}
{"ts":1342136423819,"patch":[[{"diffs":[[0,"('irc');"],[-1,"\r"],[0,"\nvar exp"]],"start1":17,"start2":17,"length1":17,"length2":16},{"diffs":[[0,"press');"],[-1,"\r\n\r"],[1,"\n"],[0,"\nvar cli"]],"start1":51,"start2":51,"length1":19,"length2":17},{"diffs":[[0,"mBot', {"],[-1,"\r\n    "],[1,"\n\t"],[0,"channels"]],"start1":114,"start2":114,"length1":22,"length2":18},{"diffs":[[0,"ombot'],"],[-1,"\r\n    "],[1,"\n\t"],[0,"password"]],"start1":138,"start2":138,"length1":22,"length2":18},{"diffs":[[0,"ASSWORD,"],[-1,"\r\n    "],[1,"\n\t"],[0,"autoConn"]],"start1":174,"start2":174,"length1":22,"length2":18},{"diffs":[[0,"alse"],[-1,"\r\n    });\r\n    \r"],[1,"\n});\n\n\n"],[0,"\nset"]],"start1":198,"start2":198,"length1":24,"length2":15},{"diffs":[[0,"nction()"],[-1,"{\r\n    "],[1," {\n\t"],[0,"client.c"]],"start1":223,"start2":223,"length1":23,"length2":20},{"diffs":[[0,"nnect();"],[-1,"\r"],[0,"\n}, 1500"]],"start1":244,"start2":244,"length1":17,"length2":16},{"diffs":[[0," 15000);"],[-1,"\r\n\r"],[1,"\n"],[0,"\nclient."]],"start1":255,"start2":255,"length1":19,"length2":17},{"diffs":[[0,"function"],[-1," "],[0,"(channel"]],"start1":293,"start2":293,"length1":17,"length2":16},{"diffs":[[0,"ssage) {"],[-1,"\r\n    "],[1,"\n\t"],[0,"client.r"]],"start1":333,"start2":333,"length1":22,"length2":18},{"diffs":[[0,"ient.raw"],[-1,"\r"],[0,"\n});"],[-1,"\r\n\r"],[1,"\n"],[0,"\nvar app"]],"start1":345,"start2":345,"length1":24,"length2":21},{"diffs":[[0,"erver();"],[-1,"\r"],[0,"\napp.use"]],"start1":384,"start2":384,"length1":17,"length2":16},{"diffs":[[0,"rser());"],[-1,"\r\n\r"],[1,"\n"],[0,"\napp.pos"]],"start1":415,"start2":415,"length1":19,"length2":17},{"diffs":[[0,"eq, res)"],[-1,"{\r\n    "],[1," {\n\t"],[0,"var push"]],"start1":449,"start2":449,"length1":23,"length2":20},{"diffs":[[0,"ayload);"],[-1,"\r\n    "],[1,"\n\t"],[0,"console."]],"start1":493,"start2":493,"length1":22,"length2":18},{"diffs":[[0,"g(push);"],[-1,"\r\n    "],[1,"\n\t"],[0,"var repo"]],"start1":513,"start2":513,"length1":22,"length2":18},{"diffs":[[0,"y.name +"],[1," "],[0,"']');"],[-1,"\r\n    "],[1,"\n\t"],[0,"//client"]],"start1":586,"start2":586,"length1":27,"length2":24},{"diffs":[[0,"mmits\");"],[-1,"\r\n    "],[1,"\n\t"],[0,"var plur"]],"start1":656,"start2":656,"length1":22,"length2":18},{"diffs":[[0,"al = '';"],[-1,"\r\n    "],[1,"\n\t"],[0,"if"],[1," "],[0,"(push.co"]],"start1":674,"start2":674,"length1":24,"length2":21},{"diffs":[[0,"ngth"],[-1,">1)\r\n    {\r\n        plural = 's';\r\n    }\r\n    "],[1," > 1) {\n\t\tplural = 's';\n\t}\n\t"],[0,"var "]],"start1":703,"start2":703,"length1":54,"length2":36},{"diffs":[[0,"\\//,"],[1," "],[0,"'');"],[-1,"\r\n    "],[1,"\n\t"],[0,"if"],[1," "],[0,"(branch"],[1," "],[0,"==="],[1," "],[0,"'')"],[-1,"\r\n    {\r\n    "],[1," {\n\t"],[0,"\tcli"]],"start1":778,"start2":778,"length1":46,"length2":37},{"diffs":[[0,"al);"],[-1,"\r\n    }\r\n    else\r\n    {\r\n        "],[1,"\n\t}\n\telse {\n\t\t"],[0,"clie"]],"start1":925,"start2":925,"length1":42,"length2":22},{"diffs":[[0,"branch);"],[-1,"\r\n        "],[1,"\n\t\t"],[0,"reponame"]],"start1":1070,"start2":1070,"length1":26,"length2":19},{"diffs":[[0,"]');"],[-1,"\r\n    }\r\n    "],[1,"\n\t}\n\t"],[0,"for"],[1," "],[0,"(var"]],"start1":1166,"start2":1166,"length1":24,"length2":17},{"diffs":[[0,"its)"],[-1,"\r\n    {\r\n        "],[1," {\n\t\t"],[0,"//co"]],"start1":1198,"start2":1198,"length1":25,"length2":13},{"diffs":[[0,"its[i]);"],[-1,"\r\n        "],[1,"\n\t\t"],[0,"var line"]],"start1":1230,"start2":1230,"length1":26,"length2":19},{"diffs":[[0,"n');"],[-1,"\r\n        "],[1,"\n\t\t"],[0,"if"],[1," "],[0,"(lin"]],"start1":1285,"start2":1285,"length1":20,"length2":14},{"diffs":[[0,"> 1)"],[-1,"\r\n        {\r\n            "],[1," {\n\t\t\t"],[0,"for"],[1," "],[0,"(var"]],"start1":1309,"start2":1309,"length1":36,"length2":18},{"diffs":[[0,"nes)"],[-1,"\r\n            {\r\n                "],[1," {\n\t\t\t\t"],[0,"if"],[1," "],[0,"(line"],[1," "],[0,"=="],[1," "],[0,"line"]],"start1":1338,"start2":1338,"length1":50,"length2":27},{"diffs":[[0,"ngth"],[-1,"-1)\r\n                {\r\n                    "],[1," - 1) {\n\t\t\t\t\t"],[0,"clie"]],"start1":1369,"start2":1369,"length1":52,"length2":21},{"diffs":[[0,"me);"],[-1,"\r\n                }\r\n                "],[1,"\n\t\t\t\t}\n\t\t\t\t"],[0,"else if"],[1," "],[0,"(line"],[1," "],[0,"==="],[1," "],[0,"0)"],[-1,"\r\n                {\r\n                    "],[1," {\n\t\t\t\t\t"],[0,"clie"]],"start1":1479,"start2":1479,"length1":103,"length2":47},{"diffs":[[0,"e]);"],[-1,"\r\n                }\r\n                else\r\n                {\r\n                    client.say('#combot', reponame + '     ' + lines[line]);\r\n                }\r\n            }\r\n        }\r\n        else\r\n        {\r\n            "],[1,"\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tclient.say('#combot', reponame + '     ' + lines[line]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t"],[0,"clie"]],"start1":1570,"start2":1570,"length1":230,"length2":115},{"diffs":[[0,"me);"],[-1,"\r\n        }\r\n        \r\n    }\r\n    "],[1,"\n\t\t}\n\n\t}\n\t"],[0,"res."]],"start1":1767,"start2":1767,"length1":42,"length2":18},{"diffs":[[0,"d();"],[-1,"\r"],[0,"\n});"],[-1,"\r\n\r"],[1,"\n"],[0,"\napp."],[-1,"ge"],[1,"pos"],[0,"t('/"],[1,"issue"],[0,"', f"]],"start1":1788,"start2":1788,"length1":27,"length2":30},{"diffs":[[0,"res)"],[-1,"{\r\n    \r\n   "],[1," {\n\t\n\t\n\t\n});\n\napp.get('/', function(req, res) {\n\n\t"],[0,"res."]],"start1":1831,"start2":1831,"length1":20,"length2":58},{"diffs":[[0,"g');"],[-1," \r\n    \r"],[1,"\n"],[0,"\n});"],[-1,"\r\n\r"],[1,"\n"],[0,"\napp"]],"start1":1905,"start2":1905,"length1":23,"length2":14}]],"length":1956,"saved":false}
{"ts":1342136740234,"patch":[[{"diffs":[[0,"res) {\n\t"],[1,"client.say('#combot', 'issue callback');"],[0,"\n\t\n\t\n});"]],"start1":1831,"start2":1831,"length1":16,"length2":56},{"diffs":[[0,");\n\t\n\t\n});\n\n"],[1,"\n\n"],[0,"app.get('/',"]],"start1":1877,"start2":1877,"length1":24,"length2":26}]],"length":1998,"saved":false}
{"ts":1342136753037,"patch":[[{"diffs":[[0,") {\n"],[-1,"\tclient.raw\n"],[0,"});\n"]],"start1":338,"start2":338,"length1":20,"length2":8}]],"length":1986,"saved":false}
